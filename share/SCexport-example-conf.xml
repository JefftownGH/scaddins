<?xml version="1.0" encoding="utf-8"?>
<!-- 
     SCexport config file template.
     Andrew Nicholas 20151027

     Place this in the same folder as your Revit Central file and rename it to
     REVIT_FILE_NAME.xml
-->
<SCexport name="Generic SCexport config file">
    <!-- #### FilenameSchemes info #### -->
    <!-- 
    Define exprort name schemes by using the one or more of the nodes <FilenameScheme>

    Available xml nodes are:
        <ProjectNumber>
        <SheetNumber>
        <Discipline>**
        <Text>**
        <Revision>
        <RevisionDescription>
        <SheetName>
        <Underscore>
        <Hyphen>

        **Can add a value to these nodes
    -->
    
    <!--This is the first scheme. The first is the default-->
    <FilenameScheme label="Architectural">
        <ProjectNumber />
        <Hyphen />
        <SheetNumber />
        <Text>[</Text>
        <Revision />
        <Text>]</Text>
    </FilenameScheme>
    
    <!--Renames dwg files after export-->
    <FilenameScheme label="Architectural USQ and ACONEX" hooks="aconexDWGSuffix">
        <ProjectNumber />
        <Hyphen />
        <SheetNumber />
        <Text>[</Text>
        <Revision />
        <Text>]</Text>
    </FilenameScheme>
    
    <!--Creates a transparent png files after each pdf export-->
    <FilenameScheme label="Marketing Plans" hooks="convertToPng">
        <ProjectNumber />
        <Hyphen />
        <SheetNumber />
        <Text>[</Text>
        <Revision />
        <Text>]</Text>
    </FilenameScheme>
    
    <!--Add a watermark-->
    <FilenameScheme label="PDF Watermarker" hooks="watermark">
        <ProjectNumber />
        <Hyphen />
        <SheetNumber />
        <Text>[</Text>
        <Revision />
        <Text>]</Text>
    </FilenameScheme>
    
    <FilenameScheme label="Landscape LD">
        <ProjectNumber />
        <Hyphen />
        <Discipline>LD</Discipline>
        <Hyphen />
        <SheetNumber />
        <Text>[</Text>
        <Revision />
        <Text>]</Text>
    </FilenameScheme>
    
    <FilenameScheme label="Brackets">
        <ProjectNumber />
        <Hyphen />
        <Discipline>
        </Discipline>
        <Hyphen />
        <SheetNumber />
        <Text>(</Text>
        <Revision />
        <Text>)</Text>
    </FilenameScheme>
    
    <FilenameScheme label="CRevisions">
        <Text>49-FV-SC001</Text>
        <Hyphen />
        <SheetNumber />
        <Underscore />
        <Text>C</Text>
        <Revision />
    </FilenameScheme>
    
    <FilenameScheme label="Simple">
        <SheetNumber />
        <Underscore />
        <Revision />
    </FilenameScheme>
    
    <!-- #### PostExportHook info #### -->
    <!--    
    Hooks will run after an export if the active FilenameScheme defines the hook name.

    Available nodes are:
     <Command>
     <Args>
     <SupportedFileExtensions>

     The following replacement strings can be used in the "Args" node:
        $height
        $width
        $fullExportName
        $fullExportPath
        $exportDir
        $pageSize
        $projectNumber
        $sheetDescription
        $sheetNumber
        $sheetRevision
        $sheetRevisionDate
        $sheetRevisionDescription
    -->
    
    
    <!--
    convert each exported pdf to a transparent png

    requirements:
        imagemagick http://imagemagick.sourceforge.net/http/www/archives.html
        ghostscript http://www.ghostscript.com/download/

    place the following text in a script called C:\Temp\createPNG.bat:

        convert -size 1920x1080 xc:white temp.png
        convert -transparent white temp.png canvas.png
        convert -fuzz 10%% -transparent white -density 300 -resize x1080 %1 temp.png
        composite -gravity center temp.png canvas.png %1.png
    -->
    <PostExportHook name="convertToPng">
        <Command>C:\Temp\createPNG.bat</Command>
        <Args>$exportDir\$fullExportName.$fileExtension</Args>
        <SupportedFileExtensions>pdf</SupportedFileExtensions>
    </PostExportHook>
    
    
    <!--simple hook to rename dwg files with a _DWG suffix-->
    <PostExportHook name="aconexDWGSuffix">
        <Command>cmd.exe</Command>
        <Args> /C RENAME "$exportDir\$fullExportName.$fileExtension" "$fullExportName_DWG.$fileExtension"</Args>
        <SupportedFileExtensions>dwg</SupportedFileExtensions>
    </PostExportHook>
    
    
    <!--add a watermark to pdf's
      requires: https://www.pdflabs.com/tools/pdftk-server/
    -->
    <PostExportHook name="watermark">
        <Command>"C:\Program Files (x86)\PDFtk Server\bin\pdftk.exe"</Command>
        <Args> "$exportDir\$fullExportName.$fileExtension" background "$exportDir\watermark.pdf" output "$exportDir\$fullExportName-WM.$fileExtension"</Args>
        <SupportedFileExtensions>pdf</SupportedFileExtensions>
    </PostExportHook>
</SCexport>

<!-- vim: set nu tabstop=4 shiftwidth=4 expandtab : -->